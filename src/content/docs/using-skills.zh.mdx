---
title: 使用 Skills
description: 如何查找和使用现有的 Agent Skills
order: 7
group: integration
---

# 使用 Skills

了解如何查找、安装和使用现有的 Agent Skills。

## 查找 Skills

### 官方示例

在 GitHub 上浏览官方 skill 示例：

- [anthropics/skills](https://github.com/anthropics/skills) - Anthropic 提供的示例 skills

### 社区 Skills

查看社区仓库和 skill 注册表（即将推出）。

## 安装 Skills

Skills 只是文件夹 - "安装"意味着把它们放在 Agent 能找到的地方。

### 支持的位置

Agent 通常搜索这些路径：

| 路径 | 作用域 |
|------|--------|
| `.opencode/skill/<name>/SKILL.md` | 项目（OpenCode） |
| `.claude/skills/<name>/SKILL.md` | 项目（Claude 兼容） |
| `~/.config/opencode/skill/<name>/SKILL.md` | 全局（OpenCode） |
| `~/.claude/skills/<name>/SKILL.md` | 全局（Claude 兼容） |

### 本地安装

```bash
# 克隆或下载 skill 到你的项目
git clone https://github.com/example/my-skill.git .opencode/skill/my-skill

# 或者从头创建
mkdir -p .opencode/skill/pdf-processor
# 添加 SKILL.md 和其他文件
```

### 目录结构

在专用文件夹中组织你的 skills：

```
.opencode/skill/
├── pdf-processor/
│   └── SKILL.md
├── code-reviewer/
│   └── SKILL.md
└── data-analyzer/
    ├── SKILL.md
    └── scripts/
        └── analyze.py
```

## Skill 发现机制

### 向上遍历发现

对于项目本地路径，Agent 会从当前工作目录向上遍历到 git 工作树根目录。它会加载沿途在 `.opencode/` 中匹配 `skill/*/SKILL.md` 和在 `.claude/skills/*/SKILL.md` 中的所有文件。

这意味着你可以有：
- 仓库根目录中的仓库级 skills
- 父目录中的组织级 skills
- 家目录中的个人 skills

### 发现顺序

1. 当前目录的 `.opencode/skill/` 和 `.claude/skills/`
2. 向上遍历到 git 根目录的父目录
3. 全局 `~/.config/opencode/skill/`
4. 全局 `~/.claude/skills/`

较近目录中同名的 skill 会覆盖父目录中的 skill。

## Agent 如何看到 Skills

### Skill 工具

Agent 会获得一个 `skill` 工具，其描述中列出了可用的 skills：

```xml
<available_skills>
  <skill>
    <name>pdf-processor</name>
    <description>从 PDF 文件中提取文本和表格</description>
  </skill>
  <skill>
    <name>code-reviewer</name>
    <description>审查代码的问题和最佳实践</description>
  </skill>
</available_skills>
```

### 加载 Skill

当 Agent 决定某个 skill 相关时，它会调用：

```javascript
skill({ name: "pdf-processor" })
```

这会将完整的 `SKILL.md` 内容加载到 Agent 的上下文中。

## 配置权限

在 Agent 的配置文件（如 `opencode.json`）中使用基于模式的权限来控制 Agent 可以访问哪些 skills：

```json
{
  "permission": {
    "skill": {
      "*": "allow",
      "pr-review": "allow",
      "internal-*": "deny",
      "experimental-*": "ask"
    }
  }
}
```

### 权限值

| 权限 | 行为 |
|------|------|
| `allow` | Skill 立即加载 |
| `deny` | Skill 对 Agent 隐藏，访问被拒绝 |
| `ask` | 加载前提示用户批准 |

### 模式匹配

模式支持通配符：
- `*` 匹配所有 skills
- `internal-*` 匹配 `internal-docs`、`internal-tools` 等
- 具体名称优先于通配符

## 按 Agent 配置权限

给特定 Agent 不同于全局默认的权限。

### 自定义 Agent（在 agent frontmatter 中）

```yaml
---
permission:
  skill:
    "documents-*": "allow"
---
```

### 内置 Agent（在配置文件中）

```json
{
  "agent": {
    "plan": {
      "permission": {
        "skill": {
          "internal-*": "allow"
        }
      }
    }
  }
}
```

## 禁用 Skills

完全禁用不应使用 skills 的 Agent 的 skills 功能：

### 自定义 Agent

```yaml
---
tools:
  skill: false
---
```

### 内置 Agent

```json
{
  "agent": {
    "plan": {
      "tools": {
        "skill": false
      }
    }
  }
}
```

禁用时，`<available_skills>` 部分会被完全省略。

## 实际使用 Skills

### 自动激活

大多数 Agent 会自动检测何时某个 skill 相关：

```
用户："我需要从 report.pdf 中提取文本"

Agent：（检测到 pdf-processor skill 相关）
       （调用 skill({ name: "pdf-processor" })）
       （将 SKILL.md 加载到上下文中）
       （按照说明处理文件）
```

### 手动激活

你可以明确请求一个 skill：

```
用户："使用 pdf-processor skill 从 report.pdf 中提取文本"
```

### 查看可用 skills

询问你的 Agent 有哪些 skills 可用：

```
用户："你有哪些 skills？"

Agent："我可以访问以下 skills：
        - pdf-processor：从 PDF 中提取文本和表格
        - code-reviewer：审查代码问题
        - data-analyzer：分析 CSV 数据文件"
```

## Skill 权限

### 脚本执行

Skills 可能包含可执行脚本。请考虑：

- **信任**：只使用来自可信来源的 skills
- **审查**：在允许执行前检查脚本
- **沙箱**：尽可能在隔离环境中运行

### 文件访问

Skills 可能需要读写文件：

- 授予最小必要权限
- 对修改文件的 skills 保持谨慎
- 备份重要数据

## 故障排除

### Skill 没有显示

如果 skill 没有出现在可用列表中：

1. **检查文件名**：验证 `SKILL.md` 是全大写拼写
2. **检查 frontmatter**：确保包含 `name` 和 `description`
3. **检查唯一性**：Skill 名称在所有位置必须唯一
4. **检查权限**：`deny` 权限的 skills 对 Agent 隐藏
5. **重启 Agent**：Agent 可能需要重新扫描 skill 目录

### Skill 没有激活

```
问题：Agent 在预期时没有使用 skill

解决方案：
1. 检查 skill 的描述是否匹配任务关键词
2. 尝试明确提及 skill 名称
3. 验证 skill 的 frontmatter 是有效的 YAML
```

### 脚本错误

```
问题：Skill 脚本无法运行

解决方案：
1. 检查脚本依赖是否已安装
2. 验证文件权限（bash 脚本需要 chmod +x）
3. 检查脚本路径引用是否正确
```

## 验证 Skills

使用 skill 前，验证它：

```bash
# 使用 skills-ref CLI
skills-ref validate ./my-skill

# 检查输出中的错误或警告
```

### 常见验证问题

| 问题 | 解决方法 |
|------|----------|
| 名称格式无效 | 只使用小写字母和连字符 |
| 缺少描述 | 在 frontmatter 中添加 description |
| 名称不匹配 | 确保 name 与目录名匹配 |
| 描述过长 | 保持在 1024 字符以内 |

## 更新 Skills

Skills 像任何代码一样进行版本控制：

```bash
# 如果使用 git
cd .opencode/skill/my-skill
git pull

# 手动更新
# 用新版本替换文件
```

## 下一步

- **[集成 Skills](/zh/docs/integrating)** - 为你自己的 Agent 添加 skills 支持
- **[示例](/zh/docs/examples)** - 浏览示例 skills
